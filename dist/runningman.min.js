!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){b.exports=function(){throw Error("[BaseClass] Abstract method was called without definition.")}},{}],2:[function(a,b){function c(a){return a.extend=function(b){var c,e={base:a.base};b=b||{};for(c in a)"function"==typeof a[c]&&(e[c]=a[c].bind(a));for(c in b)a[c]="function"==typeof b[c]?d(c,a,e,b):b[c];return a.base=e,a},a.implement=function(){var b,c=arguments.length;for(b=0;c>b;b+=1)arguments[b](a);return a},a}var d=a("./rebind.js");c.Abstract=a("./abstract.js"),c.Stub=a("./stub.js"),c.Interface=a("./interface.js"),b.exports=c},{"./abstract.js":1,"./interface.js":3,"./rebind.js":4,"./stub.js":5}],3:[function(a,b){b.exports=function(a){return function(b){var c;for(c in a)b[c]=a[c];return b}}},{}],4:[function(a,b){b.exports=function(a,b,c,d){return function(){var e,f=b.base;return b.base=c,b.self=d,e=d[a].apply(b,arguments),b.base=f,e}}},{}],5:[function(a,b){b.exports=function(){}},{}],6:[function(a,b){var c=a("./dimension.js"),d=a("./point.js");b.exports=function(a){var b,e,f=0,g=!1,h=a.frames||1,i=a.size||c(),j=a.start||d(),j=d(i.width*j.x,i.height*j.y);return b=a.speed>0?1/a.speed*1e3:0,{ready:function(){return a.sheet.ready},size:i,frame:0,load:function(b){a.sheet.load(b)},start:function(){e=Date.now(),b&&(g=!0)},pause:function(){g=!1},stop:function(){g=!1,f=0,this.frame=0},update:function(){var a,c;g&&(a=Date.now(),c=a-e,f+=c,f>=b&&(f=0,this.nextFrame()),e=a)},nextFrame:function(){return this.frame+=1,this.frame%=h,this.frame},draw:function(b,d,e,f){var g,h=this.frame*i.width;e=e||c(1,1),f=f||0,g=c(i.width*e.width,i.height*e.height),b.save(),b.translate(d.x+g.width/2,d.y+g.height/2),b.rotate(f),b.drawImage(a.sheet,j.x+h,j.y,i.width,i.height,-g.width/2,-g.height/2,g.width,g.height),b.restore()}}}},{"./dimension.js":12,"./point.js":20}],7:[function(a,b){var c=document.createElement("canvas");window.innerWidth>=500?(c.width=320,c.height=480,c.style.border="1px solid #000",c.mobile=!1):(c.width=window.innerWidth,c.height=window.innerHeight,document.body.style.height=c.height+"px",c.mobile=!0),document.body.appendChild(c),c.ctx=c.getContext("2d"),b.exports=c},{}],8:[function(a,b){{var c=a("./shape.js"),d=a("./vector.js"),e=a("./point.js");a("./dimension.js")}b.exports=function(a,b){return c({pos:a||e(),name:"circle",intersects:{rectangle:function(a){var b,c=e(this.x,this.y);return this.x>a.right?c.x=a.right:this.x<a.x&&(c.x=a.x),this.y>a.bottom?c.y=a.bottom:this.y<a.y&&(c.y=a.y),b=d(this.x-c.x,this.y-c.y),b.magnitude<this.radius},circle:function(a){var b=d(a.x-this.x,a.y-this.y);return b.magnitude<this.radius+a.radius}}}).extend({radius:b||0,draw:function(a){a.beginPath(),a.lineWidth=1,a.strokeStyle="rgba(250, 50, 50, 0.5)",a.arc(this.x,this.y,this.radius,0,2*Math.PI),a.stroke()}})}},{"./dimension.js":12,"./point.js":20,"./shape.js":24,"./vector.js":27}],9:[function(a,b){var c=a("./id-counter.js"),d=a("./event-handler.js"),e=a("baseclassjs"),f=a("./rectangle.js");b.exports=function(a){var b=c.nextId,g={},h=[];return a.collisionSets&&(h=h.concat(a.collisionSets)),e({id:b,name:a.name,mask:a.mask||f(),move:function(a,b){this.mask.move(a,b)},intersects:function(a){return this.mask.intersects(a)},update:function(){var a=this;h.forEach(function(b){b.update(a)})},teardown:e.Stub,addCollision:function(a){g[a]=!0},removeCollision:function(a){g[a]=!1},isCollidingWith:function(a){return g[a]||!1}}).implement(d({events:a.on,singles:a.one}))}},{"./event-handler.js":13,"./id-counter.js":16,"./rectangle.js":22,baseclassjs:2}],10:[function(a,b){var c=a("./rectangle.js"),d=a("./point.js"),e=a("./dimension.js");b.exports=function(a){var b,f,g,h=[],i=[],j=a.gridSize||e(1,1);for(b=0;b<j.width;b+=1)for(f=0;f<j.height;f+=1)h.push(c(d(b/j.width*a.canvasSize.width,f/j.height*a.canvasSize.height),e(a.canvasSize.width/j.width,a.canvasSize.height/j.height)));for(g=h.length,b=0;g>b;b+=1)i.push([]);return{name:a.name,draw:function(a){h.forEach(function(b){b.draw(a)}),i.forEach(function(b){b.forEach(function(b){b.mask.draw(a)})})},clearCollisions:function(){var a,b=i.length;for(a=0;b>a;a+=1)i[a]=[]},update:function(a){var b,c=i.length;for(b=0;c>b;b+=1)a.intersects(h[b])&&i[b].push(a)},handleCollisions:function(){var a,b,c=i.length;for(a=0;c>a;a+=1)b=i[a],b.forEach(function(a){b.forEach(function(b){var c,d;a.id!==b.id&&(c=a.intersects(b.mask),d=a.isCollidingWith(b.id),c?(d||(a.trigger("collide/"+b.name,b),a.addCollision(b.id)),a.trigger("colliding/"+b.name,b)):(d&&(a.trigger("separate/"+b.name,b),a.removeCollision(b.id)),a.trigger("miss/"+b.name,b)))})})},teardown:function(){this.clearCollisions()}}}},{"./dimension.js":12,"./point.js":20,"./rectangle.js":22}],11:[function(a,b){b.exports={Shape:a("./shape.js"),Circle:a("./circle.js"),Rectangle:a("./rectangle.js"),Dimension:a("./dimension.js"),Point:a("./point.js"),Vector:a("./vector.js"),Polar:a("./polar.js"),FrameCounter:a("./frame-counter.js"),IdCounter:a("./id-counter.js"),Mouse:a("./mouse.js"),Keyboard:a("./keyboard.js"),EventHandler:a("./event-handler.js"),SpriteSheet:a("./spritesheet.js"),AnimationStrip:a("./animation-strip.js"),CollisionHandler:a("./collision-handler.js"),Game:a("./game.js"),Screen:a("./screen.js"),Collidable:a("./collidable.js"),Sprite:a("./sprite.js")}},{"./animation-strip.js":6,"./circle.js":8,"./collidable.js":9,"./collision-handler.js":10,"./dimension.js":12,"./event-handler.js":13,"./frame-counter.js":14,"./game.js":15,"./id-counter.js":16,"./keyboard.js":18,"./mouse.js":19,"./point.js":20,"./polar.js":21,"./rectangle.js":22,"./screen.js":23,"./shape.js":24,"./sprite.js":25,"./spritesheet.js":26,"./vector.js":27}],12:[function(a,b){function c(a,b){return{width:a||0,height:b||0,clone:function(){return c(this.width,this.height)},equals:function(a){return this.width===a.width&&this.height===a.height}}}b.exports=c},{}],13:[function(a,b){var c=a("baseclassjs");b.exports=function(a){var b,d={},e={};a=a||{};for(b in a.events)d[b]=[a.events[b]];for(b in a.singles)e[b]=[a.singles[b]];return c.Interface({on:function(a,b){d[a]=d[a]||[],d[a].push(b)},one:function(a,b){e[a]=e[a]||[],e[a].push(b)},off:function(a){d[a]=[],e[a]=[]},trigger:function(a,b){var c=this;a in d&&d[a].forEach(function(a){a.call(c,b)}),a in e&&(e[a].forEach(function(a){a.call(c,b)}),e[a]=[])}})}},{baseclassjs:2}],14:[function(a,b){var c=frameCountThisSecond=frameRate=0,d=(new Date).getTime();b.exports={countFrame:function(){var a=(new Date).getTime(),b=a-d;frameCountThisSecond+=1,d=a,c+=b,c>=1e3&&(c-=1e3,frameRate=frameCountThisSecond,frameCountThisSecond=0)},get frameRate(){return frameRate},draw:function(a){a.font="30px Verdana",a.fillStyle="rgba(250, 50, 50, 0.5)",a.fillText(frameRate,20,50)}}},{}],15:[function(a,b){var c=a("./collision-handler.js"),d=(a("./point.js"),a("./dimension.js")),e=a("./circle.js"),f=a("./collidable.js"),g=a("./frame-counter.js"),h=a("./mouse.js"),i=a("./canvas.js"),j=i.ctx,k=a("./id-counter.js"),l=!1,m=!1,n=30,o=[],p={},q=[],r=!1,s=c({name:"screentap",gridSize:d(4,4),canvasSize:i}),t={};h.on.down(function(){s.update(f({name:"screentap",mask:e(h.offset,15)}))}),b.exports={canvas:i,screenTap:s,screen:function(a){return p[a]},addScreens:function(a){var b;a&&(a=[].concat(a),b=k.nextId,t[b]=a.length,a.forEach(function(c){c.load(function(){t[b]-=1,0===t[b]&&(q=q.concat(a))})}))},removeScreen:function(a){a.removed=!0,r=!0},run:function(a){var b,c=this;a=a||{},b=a.speed||n,l=a.debug,l&&(window.Dragon=this),m||(o.forEach(function(a){a.start()}),m=window.setInterval(function(){c.update(),c.draw(),c.teardown(),g.countFrame()},b))},kill:function(){window.clearInterval(m),m=!1,o.forEach(function(a){a.stop()})},update:function(){h.is.dragging?s.update(f({name:"screendrag",mask:e(h.offset,25)})):h.is.holding&&s.update(f({name:"screenhold",mask:e(h.offset,15)})),o.forEach(function(a){a.update()}),s.handleCollisions(),q.length&&(q.forEach(function(a){o.push(a),a.name&&(p[a.name]=a),a.trigger("ready")}),o.sort(function(a,b){return b.depth-a.depth}),q=[])},draw:function(){o.forEach(function(a){a.draw(j,l)}),l&&(g.draw(j),h.is.down&&s.draw(j))},teardown:function(){s.teardown(),o.forEach(function(a){a.teardown()}),r&&(o=o.filter(function(a){return!a.removed}),r=!1)}}},{"./canvas.js":7,"./circle.js":8,"./collidable.js":9,"./collision-handler.js":10,"./dimension.js":12,"./frame-counter.js":14,"./id-counter.js":16,"./mouse.js":19,"./point.js":20}],16:[function(a,b){var c=0;b.exports={get lastId(){return c},get nextId(){return c+=1}}},{}],17:[function(a,b){b.exports=function(a){var b=new Image;return b.ready=!1,b.cmd=[],b.processLoadEvents=function(){this.cmd.forEach(function(a){a(b)}),this.cmd=[]},b.onload=function(){this.ready=!0,this.processLoadEvents()},b.load=function(c){c=c||function(){},this.ready?c(b):(this.cmd.push(c),this.src="assets/img/"+a)},b}},{}],18:[function(a,b){function c(a){return a.charCode||a.keyCode||a.which}var d={alt:!1,ctrl:!1,shift:!1},e={};document.onkeydown=function(a){var b=c(a),f=String.fromCharCode(b);e[b]=!0,d[f]=!0,d.alt=a.altKey,d.ctrl=a.ctrlKey,d.shift=a.shiftKey},document.onkeyup=function(a){var b=c(a),f=String.fromCharCode(b);e[b]=!1,d[f]=!1,d.alt=a.altKey,d.ctrl=a.ctrlKey,d.shift=a.shiftKey},b.exports={get alt(){return d.alt},get ctrl(){return d.ctrl},get shift(){return d.shift},arrow:{get left(){return e[37]||!1},get up(){return e[38]||!1},get right(){return e[39]||!1},get down(){return e[40]||!1}},name:function(a){return d[a]||!1},code:function(a){return e[a]||!1}}},{}],19:[function(a,b){(function(c){var d,e,f,g=a("./point.js"),h=a("./vector.js"),i=a("./canvas.js"),j=!1,k=!1,l=!1,m=g(),n=g(),o=h();i.mobile?(d="touchstart",e="touchmove",f="touchend"):(d="mousedown",e="mousemove",f="mouseup"),i.addEventListener(d,function(a){j=!0,m.x=a.offsetX,m.y=a.offsetY,c.setTimeout(function(){j&&(l=!0)},200)}),document.addEventListener(f,function(){j=k=l=!1}),i.addEventListener(e,function(a){n.x=m.x,n.y=m.y,m.x=a.offsetX,m.y=a.offsetY,j&&(o.x=m.x-n.x,o.y=m.y-n.y,o.magnitude>1&&(k=!0))}),b.exports={is:{get down(){return j},get dragging(){return k},get holding(){return l}},get offset(){return m},on:{down:function(a){i.addEventListener(d,a)},up:function(a){document.addEventListener(f,a)},move:function(a){i.addEventListener(e,a)}},eventName:{start:d,move:e,end:f}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./canvas.js":7,"./point.js":20,"./vector.js":27}],20:[function(a,b){function c(a,b){return{x:a||0,y:b||0,clone:function(){return c(this.x,this.y)},equals:function(a){return this.x===a.x&&this.y===a.y}}}b.exports=c},{}],21:[function(a,b){function c(a,b,c,d){var e=a.magnitude===d*b.magnitude,f=(a.theta%Math.PI).toFixed(5),g=((b.theta+c)%Math.PI).toFixed(5);return e&&f===g}function d(a,b){return{theta:a||0,magnitude:b||0,invert:function(){return d(this.theta+Math.PI,-1*this.magnitude)},clone:function(){return d(this.theta,this.magnitude)},toVector:function(){return e(this.magnitude*Math.cos(this.theta),this.magnitude*Math.sin(this.theta))},equals:function(a){return c(this,a,0,1)||c(this,a,Math.PI,-1)}}}var e=a("./vector.js");b.exports=d},{"./vector.js":27}],22:[function(a,b){var c=a("./shape.js"),d=a("./point.js"),e=a("./dimension.js"),f=a("./vector.js");b.exports=function(a,b){return a=a||d(),b=b||e(),c({pos:a,name:"rectangle",intersects:{rectangle:function(a){return this.x<a.right&&this.right>a.x&&this.y<a.bottom&&this.bottom>a.y},circle:function(a){var b,c=d(a.x,a.y);return a.x>this.right?c.x=this.right:a.x<this.x&&(c.x=this.x),a.y>this.bottom?c.y=this.bottom:a.y<this.y&&(c.y=this.y),b=f(a.x-c.x,a.y-c.y),b.magnitude<a.radius}}}).extend({width:b.width||0,height:b.height||0,right:a.x+b.width||0,bottom:a.y+b.height||0,move:function(a,b){this.base.move(a,b),this.right=a+this.width,this.bottom=b+this.height},draw:function(a){a.beginPath(),a.lineWidth=1,a.strokeStyle="rgba(250, 50, 50, 0.5)",a.rect(this.x,this.y,this.width,this.height),a.stroke()}})}},{"./dimension.js":12,"./point.js":20,"./shape.js":24,"./vector.js":27}],23:[function(a,b){var c=a("baseclassjs"),d=a("./event-handler.js"),e=a("./id-counter.js");b.exports=function(a){var b,f=!1,g=[],h={},i=[],j={},k=!1,l={},m=!1,n=!1;return b=c({name:a.name,load:function(b){f||(this.addSprites({set:a.spriteSet,onload:b}),f=!0)},start:function(){g.forEach(function(a){a.strip.start()}),m=!0,n=!0},pause:function(){g.forEach(function(a){a.strip.pause()}),m=!1,n=!0},stop:function(){g.forEach(function(a){a.strip.stop()}),m=!1,n=!1},depth:a.depth||0,collision:function(a){return l[a]},addCollisionSets:function(a){a&&(a=[].concat(a),a.forEach(function(a){l[a.name]=a}))},sprite:function(a){return h[a]},addSprites:function(a){var b,c;a=a||{},a.set&&(c=a.onload||function(){},set=[].concat(a.set),b=e.nextId,j[b]=set.length,set.forEach(function(a){a.load(function(){j[b]-=1,0===j[b]&&(i=i.concat(set),c())})}))},removeSprite:function(a){a.removed=!0,k=!0},update:function(){var a;g.forEach(function(a){m&&!a.removed&&a.update()});for(a in l)l[a].handleCollisions();i.length&&(i.forEach(function(a){g.push(a),a.name&&(h[a.name]=a),a.strip.start()}),g.sort(function(a,b){return b.depth-a.depth}),i=[])},draw:function(a,b){var c;if(n&&(g.forEach(function(b){b.draw(a)}),b))for(c in l)l[c].draw(a)},teardown:function(){var a;m&&g.forEach(function(a){a.removed||a.teardown()});for(a in l)l[a].teardown();k&&(g=g.filter(function(a){return!a.removed}),k=!1)}}).implement(d({events:a.on,singles:a.one})),b.addCollisionSets(a.collisionSets),b}},{"./event-handler.js":13,"./id-counter.js":16,baseclassjs:2}],24:[function(a,b){var c=a("baseclassjs"),d=a("./point.js");b.exports=function(a){var b,e;return a=a||{},e=a.intersects||{},b=a.pos||d(),c({x:b.x,y:b.y,name:a.name,move:function(a,b){this.x=a,this.y=b},intersects:function(a){return e[a.name].call(this,a)},draw:c.Stub})}},{"./point.js":20,baseclassjs:2}],25:[function(a,b){var c=(a("baseclassjs"),a("./collidable.js")),d=a("./point.js"),e=a("./dimension.js");b.exports=function(a){var b=a.size||a.strip.size,f=a.strip.size,g=!1;return c(a).extend({ready:function(){return a.strip.ready()},strip:a.strip,pos:a.pos||d(),scale:a.scale||1,size:b,rotation:a.rotation||0,depth:a.depth||0,speed:a.speed||d(),update:function(){this.shift(),this.strip.update(),this.base.update()},draw:function(b){a.strip.draw(b,this.pos,e(this.scale*this.size.width/f.width,this.scale*this.size.height/f.height),this.rotation)},load:function(b){g||(a.strip.load(b),g=!0)},move:function(b,c){this.pos.x=b,this.pos.y=c,a.freemask||this.base.move(b,c)},shift:function(b,c){this.pos.x+=b||this.speed.x,this.pos.y+=c||this.speed.y,a.freemask||this.base.move(this.pos.x,this.pos.y)}})}},{"./collidable.js":9,"./dimension.js":12,"./point.js":20,baseclassjs:2}],26:[function(a,b){var c=a("./image.js"),d={};b.exports=function(a){var b,e=a.src;return e in d?b=d[e]:(b=c(e),d[e]=b),b}},{"./image.js":17}],27:[function(a,b){function c(a,b){return{x:a||0,y:b||0,get magnitude(){return Math.abs(Math.sqrt(this.y*this.y+this.x*this.x))},invert:function(){return this.scale(-1)},clone:function(){return c(this.x,this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},scale:function(a){return c(this.x*a,this.y*a)},toPolar:function(){return d(Math.atan(this.y/this.x),this.magnitude)}}}var d=a("./polar.js");b.exports=c},{"./polar.js":21}],28:[function(a,b){var c=a("dragonjs"),d=c.Dimension,e=c.CollisionHandler,f=c.Game;b.exports=e({name:"environ",gridSize:d(5,5),canvasSize:f.canvas})},{dragonjs:11}],29:[function(a){var b=a("dragonjs"),c=b.Game,d=a("./screens/main.js");c.addScreens(d),c.run({debug:!0})},{"./screens/main.js":30,dragonjs:11}],30:[function(a,b){var c=a("dragonjs"),d=c.Screen,e=a("../sprites/sky.js"),f=a("../sprites/runner.js"),g=a("../sprites/ground.js"),h=a("../collisions/main.js");b.exports=d({name:"main",collisionSets:h,spriteSet:[e,f,g(0),g(81),g(162),g(243)],one:{ready:function(){this.start()}}})},{"../collisions/main.js":28,"../sprites/ground.js":31,"../sprites/runner.js":32,"../sprites/sky.js":33,dragonjs:11}],31:[function(a,b){var c=a("dragonjs"),d=c.Game.canvas,e=c.Point,f=c.Dimension,g=c.Rectangle,h=(c.Circle,c.Sprite),i=c.AnimationStrip,j=c.SpriteSheet,k=a("../collisions/main.js");b.exports=function(a){return h({name:"ground",collisionSets:k,mask:g(e(a,d.height-79),f(81,40)),freemask:!0,strip:i({sheet:j({src:"ground.png"}),size:f(81,79)}),pos:e(a,d.height-79),depth:8})}},{"../collisions/main.js":28,dragonjs:11}],32:[function(a,b){var c=a("dragonjs"),d=c.Game,e=c.Mouse,f=(c.Keyboard,c.Point),g=c.Dimension,h=c.Rectangle,i=c.Sprite,j=c.AnimationStrip,k=c.SpriteSheet,l=(c.Polar,a("../collisions/main.js"));b.exports=i({name:"runner",collisionSets:[l,d.screenTap],mask:h(f(100,104),g(64,60)),strip:j({sheet:k({src:"orc-walk.png"}),start:f(1,11),size:g(64,64),frames:8,speed:8}),pos:f(100,100),depth:2,on:{"colliding/ground":function(a){this.speed.y=0,this.pos.y=a.pos.y-this.mask.height},"collide/screendrag":function(){var a=e.offset.clone();a.x-=this.size.width/2,a.y-=this.size.height/2,this.move(a.x,a.y),this.speed.y=0},"collide/screentap":function(){this.speed.y=-30}}}).extend({update:function(){this.speed.y+=3,this.base.update()}})},{"../collisions/main.js":28,dragonjs:11}],33:[function(a,b){{var c=a("dragonjs"),d=c.Game,e=(c.Point,c.Dimension),f=c.Sprite,g=c.AnimationStrip,h=c.SpriteSheet;a("../collisions/main.js")}b.exports=f({name:"sky",strip:g({sheet:h({src:"sky.png"}),size:e(5,400)}),size:d.canvas,depth:10})},{"../collisions/main.js":28,dragonjs:11}]},{},[29]);